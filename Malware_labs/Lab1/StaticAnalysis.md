# Static Analysis of Lab 1 
## Lab 1-1
Objectives for the first sample of malware:
1. Upload the files to [Virtus Total](http://www.VirusTotal.com/) and view the reports. Does either file match any existing antivirus signatures?
2. When were these files compiled?
3. Are there any indications that either of these files is packed or obfuscated? If so, what are these indicators?
4. Do any imports hint at what this malware does? If so, which imports are they?
5. Are there any other files or host-based indicators that you could look for on infected systems?
6. What network-based indicators could be used to find this malware on infected machines?
7. What would you guess is the purpose of these files?

### VirusTotal Results
To begin the static analysis of, the textbook recommends to first take a hash of the `.exe` and `.dll` files. This will provide the analyst with a hash that can be search on the internet and possibly provide more useful infomration about the files and virus. 

Using HashMyFiles we were able to find the hashes of Lab01-01.exe and Lab01-01.dll 

![Lab01-01.dll hash](../../Images/lab01-01-dll.png)  

![Lab01-01.exe hash](../../Images/lab01-01-exe.png)

Using [VirusTotal](https://www.virustotal.com) we are able to use the search feature and copy and paste the MD5 hashes of the files.

![VirusTotal search](../../Images/VirusTotal_search.png)

The Lab01-01.dll file got a hit:

![VirusTotal Lab01-01.dll](../../Images/VT_lab01-01-dll.png)

The Lab01-01.exe file also got a hit:

![VirusTotal Lab01-01.exe](../../Images/VT_lab01-01-exe.png)

<!-- ![MD5 Hash Lab1](../../Images/MD5_Hash_Lab1.PNG)

This hash can be searched for on the [Virus Total Webiste](https://www.virustotal.com/gui/home/search)


![Virus Total Search](../../Images/virusTotalHashSearch.PNG)

However, the virus total website search tool is not supported in Windows XP. I chose to proceed with Virus Total scan through Virus Total Scanner Application which is still supported on Windows XP. 

![Virus Total Scanner](../../Images/virustotalScannerDownload.PNG)

![Virus Total Scanner Results](../../Images/VirusTotalScannerLab1-1.PNG)

The search did not provide any useful information as the hash was not known to Virus Total. Entering the hash into the website search tool on a different system also did not provide any results.  -->

### Compiled Times
The lab then asks when this file was compiled. To do this we will use a tool called PEview. 

First look at the file with PEview with an omninous warning message- spooky :ghost:. 

![Warning characters data](../../Images/warning_string.PNG)

The compile time is locate in the image file headers. Compile Time: 2010/12/19 16:16:19 UTC

![PEview Compile Time](../../Images/PEview_compileTime.PNG)

### To Pack or not to Pack that is the question
The next step is to determine if the file is packed. I downloaded the PEid program to assist with this from (https://www.softpedia.com/get/Programming/Packers-Crypters-Protectors/PEiD-updated.shtml). After installing this program, I was able to select the executable file to scan. The resulsts indicated that this file was not packed but used Microsoft Visual C++ as a compiler. This was true for both the `.exe` and `.dll` files. 

![PEid result](../../Images/PEid_result.PNG)

### Imported Files
Question 4 wants us to look at the imports of the files. Using PEStudios we were able to view the different imports. One of the nice things about PEStudios is that it will flag different imports that are usually found in Malware!

Looking at the `.dll` file we see the following imports:

![libraries dll](../../Images/libraries_lab01-01-dll.png)

Examining the libraries it seems that this malware opens a socket to connect to something as well as creates a new process. 

Looking at the `.exe` file we see the following imports:

![libraries exe](../../Images/libraries_lab01-01-exe.png)

Examining the libraries it seems that this malware is going through files and looking into [UnmapViewOfFile](https://learn.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-unmapviewoffile) import we see that this will allow the memory space of the file to be overwritten. So potentially a ransomware, since it also maps the view of the file. I would assume this would be to allow the user to gain access to their files again after paying the ransom.

### Other host-based indicators
Question 5 was asking

### Network-based indicators
Looking at the strings for `.dll` file we notice an IP address. Since the `.exe` was using 

<!-- ![Dependency Walker](../../Images/dependencyWalker.PNG)

![Imported Functions](../../Images/ImportedFunctions_Lab1.PNG) -->

